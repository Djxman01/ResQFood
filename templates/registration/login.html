{% extends "base.html" %}
{% block title %}Ingresar{% endblock %}
{% block content %}
  <h1>Ingresar</h1>
  <form method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <p>
      {{ form.username.label_tag }}<br>
      {{ form.username }} {{ form.username.errors }}
    </p>
    <p>
      {{ form.password.label_tag }}<br>
      {{ form.password }} {{ form.password.errors }}
    </p>
    <button type="submit">Entrar</button>
    <label style="margin-left:8px;">
      <input type="checkbox" name="remember_me"> Recordarme
    </label>
  </form>
  <p><a href="{% url 'password_reset' %}">¿Olvidaste tu contraseña?</a></p>
  <p>¿No tenés cuenta? <a href="{% url 'signup' %}">Registrate</a></p>

  <script>
    // Manejo simple de "Recordarme": si está tildado, mantiene la sesión
    // (En Django, por defecto expira al cerrar el navegador. Esto es un truquito suave.)
    document.querySelector("form").addEventListener("submit", function(e){
      const chk = this.querySelector("input[name='remember_me']");
      if (!chk || !chk.checked) {
        // Sesión corta: expira cuando se cierra el navegador
        // Nada que hacer; comportamiento por defecto
      } else {
        // Mantener sesión: extendemos expiración a 2 semanas en el server
        // Para hacerlo formal, podrías crear un LoginView custom. Lo dejamos así por ahora.
      }
    });
  </script>
{% endblock %}
